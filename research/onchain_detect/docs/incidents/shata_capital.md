# ShataCapital 보안 사고 분석

## 개요

| 항목 | 내용 |
|------|------|
| 프로젝트 | Shata Capital |
| 데이터 기간 | 2022년 10월 ~ 2023년 1월 |
| 공격 유형 | DeFi 익스플로잇 (상세 분석 필요) |
| 데이터셋 크기 | 23 파일 (가장 작음) |

---

## 1. 프로젝트 배경

### 1.1 Shata Capital이란?

Shata Capital은 DeFi 투자/자산 관리 프로젝트입니다.

**주요 특징:**
- 탈중앙화 투자 플랫폼
- 자산 관리 서비스 제공
- 스마트 컨트랙트 기반 자금 관리

---

## 2. 데이터셋 구성

### 2.1 파일 분포

| 레이블 | 파일 수 | 비율 | 설명 |
|--------|--------|------|------|
| Benign | 20 | 87.0% | 정상적인 플랫폼 사용 트랜잭션 |
| Malicious | 2 | 8.7% | 공격 트랜잭션 |
| Excluded | 1 | 4.3% | 분석에서 제외된 트랜잭션 |

### 2.2 데이터 특성

| 항목 | 값 |
|------|-----|
| 총 크기 | 4.0 MB |
| 평균 콜 깊이 | 8.13 |
| 최대 콜 깊이 | 16 |
| 평균 총 콜 수 | 117.13 |

**주목할 점:**
- 가장 작은 데이터셋이지만 가장 복잡한 트랜잭션 구조
- 평균 총 콜 수가 117로 매우 높음 (전체 평균의 9배)
- 최대 콜 깊이 16은 전체 데이터셋 중 가장 깊음

---

## 3. 악성 트랜잭션 분석

### 3.1 악성 트랜잭션 상세

| 파일명 | 블록 번호 | 콜 깊이 | 총 콜 수 | 특징 |
|--------|----------|--------|---------|------|
| `16696240-0.json` | 16,696,240 | 16 | 308 | 가장 복잡한 공격 |
| `16696260-0.json` | 16,696,260 | 16 | 239 | 후속 공격 |

### 3.2 공격 특징

**트랜잭션 복잡도:**
- 두 악성 트랜잭션 모두 16단계의 콜 깊이
- 총 콜 수가 각각 308개, 239개로 매우 복잡
- 블록 번호 차이가 20블록 (약 4분)

### 3.3 Benign vs Malicious 비교

| 특성 | Benign (평균) | Malicious (평균) |
|------|--------------|-----------------|
| 콜 깊이 | ~6-7 | 16 |
| 총 콜 수 | ~60-80 | 273.5 |
| 블록 차이 | 분산됨 | 연속 20블록 |

---

## 4. 콜 구조 분석

### 4.1 높은 복잡도의 의미

ShataCapital의 트랜잭션이 복잡한 이유:

1. **복잡한 DeFi 전략**: 여러 프로토콜 간 상호작용
2. **Flash Loan 패턴**: 대출 → 공격 → 상환 사이클
3. **다중 토큰 스왑**: 여러 DEX를 통한 차익 거래

### 4.2 공격 패턴 추정

블록 16696240의 308개 콜로 추정되는 공격 흐름:

```
CALL (진입점)
├── CALL (Flash Loan 대출)
│   ├── DELEGATECALL (프로토콜 A)
│   │   ├── CALL (스왑 1)
│   │   ├── CALL (스왑 2)
│   │   └── ... (다수의 스왑)
│   ├── CALL (프로토콜 B 상호작용)
│   │   └── ... (복잡한 중첩)
│   └── ...
├── CALL (Flash Loan 상환)
└── logs (이익 실현)
```

---

## 5. 블록 범위 분석

### 5.1 시간적 분포

| 항목 | 값 |
|------|-----|
| 최소 블록 | ~15,698,000 |
| 최대 블록 | ~16,696,000 |
| 블록 범위 | ~998,000 블록 |
| 대략적 시기 | 2022년 10월 ~ 2023년 1월 |

### 5.2 공격 시점

악성 트랜잭션 블록 번호: 16,696,240 ~ 16,696,260
- 데이터 수집 기간의 가장 마지막 부분
- 약 2023년 1월 경으로 추정

---

## 6. 탐지 지표

### 6.1 ShataCapital 특화 지표

이 데이터셋에서 관찰된 특이한 패턴:

1. **극도로 높은 콜 수**: 200개 이상의 내부 콜
2. **깊은 중첩**: 16단계 콜 깊이
3. **연속 블록 공격**: 20블록 내 다중 트랜잭션

### 6.2 일반적 DeFi 공격 지표

```
1. Flash Loan 패턴
   - Aave/dYdX 등에서 대출
   - 동일 트랜잭션 내 상환

2. 차익 거래 패턴
   - 다수의 DEX 스왑
   - 복잡한 토큰 경로

3. 가격 조작 패턴
   - 유동성 풀 조작
   - 오라클 공격
```

---

## 7. 통계 요약

### 7.1 기본 통계

```
프로젝트: ShataCapital
총 파일 수: 23
총 크기: 4.0 MB
benign: 20 (87.0%)
malicious: 2 (8.7%)
excluded: 1 (4.3%)
```

### 7.2 복잡도 비교 (전체 데이터셋 대비)

| 항목 | ShataCapital | 전체 평균 | 배수 |
|------|-------------|----------|------|
| 평균 콜 깊이 | 8.13 | 5.19 | 1.6x |
| 평균 총 콜 수 | 117.13 | 12.79 | 9.2x |
| 최대 콜 깊이 | 16 | 11 | 1.5x |

---

## 8. 데이터 활용 시 고려사항

### 8.1 장점

1. **복잡한 공격 패턴**: 고급 DeFi 공격 학습에 유용
2. **높은 Malicious 비율**: 8.7%로 상대적으로 높음
3. **최근 데이터**: 2023년 초 데이터

### 8.2 한계점

1. **작은 샘플 크기**: 총 23개 파일만 포함
2. **상세 정보 부족**: 공격 배경 정보 제한적
3. **불균형**: Benign 20개 vs Malicious 2개

### 8.3 권장 활용 방법

1. **복잡한 공격 패턴 분석**: 깊은 콜 트리 분석 연습
2. **보조 데이터셋**: 다른 프로젝트와 함께 사용
3. **엣지 케이스 테스트**: 극단적 복잡도의 트랜잭션 처리 테스트

---

## 참고 사항

ShataCapital에 대한 공개된 보안 사고 보고서는 현재 확인되지 않았습니다.
추가 조사가 필요합니다.
