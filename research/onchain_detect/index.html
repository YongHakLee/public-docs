<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="블록체인 온체인 데이터 이상징후 탐지 연구 보고서 - BlockScan, BlockGPT, AnoFormer 비교 분석"
    />
    <meta
      name="keywords"
      content="블록체인, 이상징후 탐지, BlockScan, BlockGPT, AnoFormer, Transformer, Ethereum, Solana"
    />
    <meta name="author" content="Research Report" />

    <!-- Open Graph -->
    <meta
      property="og:title"
      content="블록체인 온체인 데이터 이상징후 탐지 연구 보고서"
    />
    <meta
      property="og:description"
      content="BlockScan, BlockGPT, AnoFormer 세 가지 접근 방식 심층 분석"
    />
    <meta property="og:type" content="article" />

    <title>블록체인 온체인 데이터 이상징후 탐지 연구 보고서</title>

    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/print.css" media="print" />
  </head>
  <body>
    <div class="page-wrapper">
      <!-- 헤더 -->
      <header class="site-header">
        <button
          class="theme-toggle"
          id="themeToggle"
          aria-label="다크 모드 전환"
        >
          <span class="theme-toggle__icon--light">🌙</span>
          <span class="theme-toggle__icon--dark">☀️</span>
        </button>
        <div class="header__container">
          <h1 class="header__title">블록체인 온체인 데이터 이상징후 탐지</h1>
          <p class="header__subtitle">
            BlockScan, BlockGPT, AnoFormer 비교 분석
          </p>
        </div>
      </header>

      <!-- 목차 오버레이 (모바일) -->
      <div class="toc-overlay" id="tocOverlay"></div>

      <!-- 목차 -->
      <nav class="toc" id="toc" aria-label="목차">
        <div class="toc__header">
          <h2 class="toc__title">목차</h2>
          <button class="toc__close" id="tocClose" aria-label="목차 닫기">
            ✕
          </button>
        </div>
        <ul class="toc__list">
          <li class="toc__item">
            <a href="#executive-summary" class="toc__link">Executive Summary</a>
          </li>
          <li class="toc__item">
            <a href="#section-1" class="toc__link">1. BlockScan</a>
            <ul class="toc__sublist">
              <li><a href="#section-1-1" class="toc__link">1.1 개요</a></li>
              <li>
                <a href="#section-1-2" class="toc__link"
                  >1.2 핵심 기술적 혁신</a
                >
              </li>
              <li>
                <a href="#section-1-3" class="toc__link">1.3 성능 평가</a>
              </li>
              <li>
                <a href="#section-1-4" class="toc__link">1.4 강점과 한계</a>
              </li>
            </ul>
          </li>
          <li class="toc__item">
            <a href="#section-2" class="toc__link">2. BlockGPT</a>
            <ul class="toc__sublist">
              <li><a href="#section-2-1" class="toc__link">2.1 개요</a></li>
              <li>
                <a href="#section-2-2" class="toc__link"
                  >2.2 핵심 기술적 접근</a
                >
              </li>
              <li>
                <a href="#section-2-3" class="toc__link">2.3 성능 평가</a>
              </li>
              <li>
                <a href="#section-2-4" class="toc__link">2.4 강점과 한계</a>
              </li>
            </ul>
          </li>
          <li class="toc__item">
            <a href="#section-3" class="toc__link">3. AnoFormer</a>
            <ul class="toc__sublist">
              <li><a href="#section-3-1" class="toc__link">3.1 개요</a></li>
              <li>
                <a href="#section-3-2" class="toc__link"
                  >3.2 핵심 기술적 혁신</a
                >
              </li>
              <li>
                <a href="#section-3-3" class="toc__link">3.3 성능 평가</a>
              </li>
              <li>
                <a href="#section-3-4" class="toc__link"
                  >3.4 블록체인 적용 가능성</a
                >
              </li>
              <li>
                <a href="#section-3-5" class="toc__link">3.5 강점과 한계</a>
              </li>
            </ul>
          </li>
          <li class="toc__item">
            <a href="#section-4" class="toc__link">4. 종합 비교 분석</a>
            <ul class="toc__sublist">
              <li>
                <a href="#section-4-1" class="toc__link">4.1 기술적 비교</a>
              </li>
              <li>
                <a href="#section-4-2" class="toc__link">4.2 탐지 능력 비교</a>
              </li>
              <li>
                <a href="#section-4-3" class="toc__link"
                  >4.3 적용 시나리오별 권장</a
                >
              </li>
              <li>
                <a href="#section-4-4" class="toc__link"
                  >4.4 이상징후 탐지 관점 분류</a
                >
              </li>
            </ul>
          </li>
          <li class="toc__item">
            <a href="#section-5" class="toc__link">5. 결론 및 권장사항</a>
            <ul class="toc__sublist">
              <li>
                <a href="#section-5-1" class="toc__link">5.1 핵심 결론</a>
              </li>
              <li><a href="#section-5-2" class="toc__link">5.2 권장사항</a></li>
              <li>
                <a href="#section-5-3" class="toc__link">5.3 향후 연구 방향</a>
              </li>
            </ul>
          </li>
          <li class="toc__item">
            <a href="#section-6" class="toc__link">6. 학습 데이터셋</a>
            <ul class="toc__sublist">
              <li>
                <a href="#section-6-1" class="toc__link">6.1 데이터셋 개요</a>
              </li>
              <li>
                <a href="#section-6-2" class="toc__link">6.2 데이터 분석</a>
              </li>
              <li>
                <a href="#section-6-3" class="toc__link">6.3 JSON 스키마</a>
              </li>
              <li>
                <a href="#section-6-4" class="toc__link">6.4 보안 사고 분석</a>
              </li>
              <li>
                <a href="#section-6-5" class="toc__link"
                  >6.5 연구자 권장사항</a
                >
              </li>
            </ul>
          </li>
          <li class="toc__item">
            <a href="#sources" class="toc__link">Sources</a>
          </li>
        </ul>
      </nav>

      <!-- 메인 콘텐츠 -->
      <main class="content">
        <article class="report">
          <!-- Executive Summary -->
          <section id="executive-summary" class="report__section">
            <h2 class="section__title">Executive Summary</h2>
            <div class="executive-summary">
              <p>
                본 보고서는 블록체인 온체인 데이터 이상징후 탐지 관점에서
                <strong>BlockScan</strong>, <strong>BlockGPT</strong>,
                <strong>AnoFormer</strong> 세 가지 접근 방식을 심층 분석합니다.
                이 세 모델은 모두 Transformer 기반 아키텍처를 활용하지만, 목적과
                적용 영역에서 중요한 차이가 있습니다.
              </p>
            </div>

            <figure class="table-container">
              <figcaption class="table__caption">모델 비교 개요</figcaption>
              <table class="data-table">
                <thead>
                  <tr>
                    <th>모델</th>
                    <th>주요 대상</th>
                    <th>접근 방식</th>
                    <th>발표 연도</th>
                    <th>주요 기여 기관</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong>BlockScan</strong></td>
                    <td>블록체인 트랜잭션 (Ethereum, Solana)</td>
                    <td>커스터마이징된 Transformer + MLM</td>
                    <td>2024-2025</td>
                    <td>NeurIPS 2025</td>
                  </tr>
                  <tr>
                    <td><strong>BlockGPT</strong></td>
                    <td>Ethereum DeFi 트랜잭션</td>
                    <td>GPT 기반 Causal LM</td>
                    <td>2023</td>
                    <td>UC Berkeley RDI</td>
                  </tr>
                  <tr>
                    <td><strong>AnoFormer</strong></td>
                    <td>일반 시계열 데이터</td>
                    <td>Transformer-GAN + Two-step Masking</td>
                    <td>2022-2023</td>
                    <td>NeurIPS 2022</td>
                  </tr>
                </tbody>
              </table>
            </figure>

            <blockquote class="theorem">
              <p class="theorem__label"><strong>핵심 결론</strong></p>
              <p class="theorem__content">
                BlockScan이 블록체인 특화 이상징후 탐지에서 가장 우수한 성능을
                보이며, Solana를 포함한 다중 체인 지원과 낮은 False Positive
                Rate가 특징입니다. BlockGPT는 실시간 침입 탐지 시스템으로서의
                잠재력이 있으나 BlockScan 대비 성능이 낮습니다. AnoFormer는
                블록체인 전용이 아닌 범용 시계열 이상징후 탐지 모델입니다.
              </p>
            </blockquote>
          </section>

          <hr />

          <!-- 섹션 1: BlockScan -->
          <section id="section-1" class="report__section">
            <h2 class="section__title">
              <span class="section__number">1.</span> BlockScan - 블록체인
              트랜잭션 이상징후 탐지
            </h2>

            <section id="section-1-1" class="report__subsection">
              <h3 class="subsection__title">1.1 개요</h3>
              <p>
                BlockScan은 <strong>NeurIPS 2025</strong>에 발표된 블록체인
                트랜잭션 이상징후 탐지를 위한 커스터마이징된 Transformer
                모델입니다. 기존의 규칙 기반 시스템이나 범용 LLM을 직접 적용하는
                방식과 달리, 블록체인 트랜잭션의 고유한 데이터 구조를 효과적으로
                모델링하기 위한 맞춤형 설계를 도입했습니다.
              </p>
            </section>

            <section id="section-1-2" class="report__subsection">
              <h3 class="subsection__title">1.2 핵심 기술적 혁신</h3>

              <section id="section-1-2-1" class="report__subsubsection">
                <h4 class="subsubsection__title">
                  1.2.1 모듈화된 토크나이저 (Modularized Tokenizer)
                </h4>
                <p>
                  블록체인 트랜잭션은 <strong>멀티모달</strong> 특성을 가집니다:
                </p>
                <ul class="content__list">
                  <li>블록체인 특화 토큰</li>
                  <li>텍스트 (함수명, 로그 메시지 등)</li>
                  <li>숫자 (금액, 가스 등)</li>
                </ul>
                <p>
                  BlockScan은 이러한 멀티모달 입력을 처리하기 위한 새로운
                  모듈화된 토크나이저를 설계했습니다:
                </p>

                <figure class="code-block">
                  <figcaption class="code__caption">
                    토크나이저 처리 흐름
                  </figcaption>
                  <pre
                    class="code__pre"
                  ><code class="code__content">[원시 JSON 데이터]
    → 함수 호출 시퀀스로 플래튼화 (Depth-first search)
    → [START], [END] 토큰으로 함수 호출 경계 식별
    → [Ins], [OUTs] 토큰으로 입출력 구분</code></pre>
                </figure>
              </section>

              <section id="section-1-2-2" class="report__subsubsection">
                <h4 class="subsubsection__title">
                  1.2.2 RoPE + FlashAttention 통합
                </h4>
                <p>긴 트랜잭션 시퀀스 처리를 위해:</p>
                <ul class="content__list">
                  <li>
                    <strong>RoPE (Rotary Position Embeddings)</strong>:
                    RoBERTa의 절대 위치 임베딩을 대체하여 장거리 의존성 처리
                    효율화
                  </li>
                  <li>
                    <strong>FlashAttention</strong>: 어텐션 메커니즘 가속화로
                    메모리 효율성 향상 및 연산 오버헤드 감소
                  </li>
                </ul>
              </section>

              <section id="section-1-2-3" class="report__subsubsection">
                <h4 class="subsubsection__title">
                  1.2.3 커스터마이징된 Masked Language Modeling
                </h4>
                <p>
                  블록체인 트랜잭션 코퍼스에서 사전학습을 위한 맞춤형 MLM
                  메커니즘을 설계하여, 정상 트랜잭션 패턴을 학습합니다.
                </p>
              </section>

              <section id="section-1-2-4" class="report__subsubsection">
                <h4 class="subsubsection__title">1.2.4 이상징후 탐지 방법</h4>
                <p>
                  모델 출력을 기반으로 한 새로운 이상징후 탐지 방법을 제안하며,
                  이론적 분석을 함께 제공합니다:
                </p>

                <blockquote class="theorem">
                  <p class="theorem__label"><strong>정리 4.1</strong></p>
                  <p class="theorem__content">
                    악의적 트랜잭션의 분포와 양성 트랜잭션 분포 간의 발산이
                    클수록, 악의적 데이터의 손실 상한이 증가합니다. 따라서
                    악의적 트랜잭션은 양성 트랜잭션보다 높은 예측 손실(즉, 이상
                    점수)을 산출할 것으로 예상됩니다.
                  </p>
                </blockquote>
              </section>
            </section>

            <section id="section-1-3" class="report__subsection">
              <h3 class="subsection__title">1.3 성능 평가</h3>

              <figure class="table-container">
                <figcaption class="table__caption">
                  Ethereum 데이터셋 성능 (k=20 기준)
                </figcaption>
                <table class="data-table data-table--metrics">
                  <thead>
                    <tr>
                      <th>메트릭</th>
                      <th>BlockScan</th>
                      <th>BlockGPT</th>
                      <th>Doc2Vec</th>
                      <th>GPT-4o</th>
                      <th>Heuristic</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>FPR</strong></td>
                      <td><span class="highlight">0.28%</span></td>
                      <td>1.0%</td>
                      <td>1.13%</td>
                      <td>1.13%</td>
                      <td>1.13%</td>
                    </tr>
                    <tr>
                      <td><strong>Recall</strong></td>
                      <td><span class="highlight">80%</span></td>
                      <td>27.78%</td>
                      <td>0%</td>
                      <td>0%</td>
                      <td>0%</td>
                    </tr>
                    <tr>
                      <td><strong>Precision</strong></td>
                      <td><span class="highlight">80%</span></td>
                      <td>25%</td>
                      <td>0%</td>
                      <td>0%</td>
                      <td>0%</td>
                    </tr>
                  </tbody>
                </table>
              </figure>

              <figure class="table-container">
                <figcaption class="table__caption">
                  Solana 데이터셋 성능 (k=20 기준)
                </figcaption>
                <table class="data-table data-table--metrics">
                  <thead>
                    <tr>
                      <th>메트릭</th>
                      <th>BlockScan</th>
                      <th>BlockGPT</th>
                      <th>Doc2Vec</th>
                      <th>GPT-4o</th>
                      <th>Heuristic</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>FPR</strong></td>
                      <td><span class="highlight">0.47%</span></td>
                      <td>-</td>
                      <td>1.13%</td>
                      <td>1.13%</td>
                      <td>1.13%</td>
                    </tr>
                    <tr>
                      <td><strong>Recall</strong></td>
                      <td><span class="highlight">72.22%</span></td>
                      <td>-</td>
                      <td>0%</td>
                      <td>0%</td>
                      <td>0%</td>
                    </tr>
                    <tr>
                      <td><strong>Precision</strong></td>
                      <td><span class="highlight">65%</span></td>
                      <td>-</td>
                      <td>0%</td>
                      <td>0%</td>
                      <td>0%</td>
                    </tr>
                  </tbody>
                </table>
              </figure>

              <blockquote class="note">
                <p class="note__label">핵심 발견</p>
                <p class="note__content">
                  BlockScan은
                  <strong
                    >Solana에서 높은 정확도로 이상 트랜잭션을 탐지하는 유일한
                    방법</strong
                  >입니다. 다른 모든 접근 방식은 매우 낮거나 0%의 탐지 재현율을
                  달성했습니다.
                </p>
              </blockquote>
            </section>

            <section id="section-1-4" class="report__subsection">
              <h3 class="subsection__title">1.4 강점과 한계</h3>

              <p><strong>강점:</strong></p>
              <ul class="content__list">
                <li>블록체인 트랜잭션의 고유한 멀티모달 특성에 최적화</li>
                <li>낮은 False Positive Rate</li>
                <li>Ethereum과 Solana 모두 지원하는 다중 체인 호환성</li>
                <li>오픈소스 공개 (코드, 모델, 데이터셋)</li>
                <li>이론적 뒷받침이 있는 탐지 방법</li>
              </ul>

              <p><strong>한계:</strong></p>
              <ul class="content__list">
                <li>사전 학습에 상당한 연산 자원 필요</li>
                <li>새로운 블록체인 네트워크 적용 시 재학습 필요</li>
              </ul>
            </section>
          </section>

          <hr />

          <!-- 섹션 2: BlockGPT -->
          <section id="section-2" class="report__section">
            <h2 class="section__title">
              <span class="section__number">2.</span> BlockGPT - 블록체인 대규모
              언어 모델
            </h2>

            <section id="section-2-1" class="report__subsection">
              <h3 class="subsection__title">2.1 개요</h3>
              <p>
                BlockGPT는
                <strong
                  >UC Berkeley RDI (Responsible Decentralized
                  Intelligence)</strong
                >에서 개발한 실시간 블록체인 트랜잭션 이상징후 탐지 도구입니다.
                2023년에 발표되었으며, GPT 스타일의 인과적(causal) Transformer를
                활용하여 이상 거래를 탐지하는 실시간 침입 탐지 시스템(IDS)으로
                설계되었습니다.
              </p>
            </section>

            <section id="section-2-2" class="report__subsection">
              <h3 class="subsection__title">2.2 핵심 기술적 접근</h3>

              <section id="section-2-2-1" class="report__subsubsection">
                <h4 class="subsubsection__title">2.2.1 트레이싱 표현 생성</h4>
                <p>
                  BlockGPT는 블록체인 활동의
                  <strong>트레이싱 표현(Tracing Representations)</strong>을
                  생성합니다:
                </p>

                <figure class="code-block">
                  <figcaption class="code__caption">
                    트레이싱 표현 생성 과정
                  </figcaption>
                  <pre
                    class="code__pre"
                  ><code class="code__content">[EVM 실행 추적]
    → 지속적 저장소 읽기/쓰기 작업 추출
    → 커스텀 데이터 인코딩 (Transformer 호환)
    → 도메인 특화 토크나이제이션
    → 트리 인코딩 (EVM 추적 표현용)</code></pre>
                </figure>
              </section>

              <section id="section-2-2-2" class="report__subsubsection">
                <h4 class="subsubsection__title">
                  2.2.2 자기지도 학습 (Self-supervised Learning)
                </h4>
                <ul class="content__list">
                  <li>
                    대량의 <strong>정상 트랜잭션 데이터</strong>로 GPT 스타일
                    인과적 Transformer 학습
                  </li>
                  <li>다음 토큰 예측을 통해 정상 패턴의 분포 학습</li>
                  <li>
                    악의적 트랜잭션은 학습된 정상 패턴에서 이탈할 것으로 가정
                  </li>
                </ul>
              </section>

              <section id="section-2-2-3" class="report__subsubsection">
                <h4 class="subsubsection__title">2.2.3 이상 점수 계산</h4>
                <p>각 트랜잭션에 대해:</p>

                <figure class="code-block">
                  <figcaption class="code__caption">
                    이상 점수 계산 공식
                  </figcaption>
                  <pre
                    class="code__pre"
                  ><code class="code__content">이상 점수 = Σ(각 토큰의 조건부 로그-우도)
낮은 총 우도 = 높은 악의적 가능성</code></pre>
                </figure>
              </section>
            </section>

            <section id="section-2-3" class="report__subsection">
              <h3 class="subsection__title">2.3 성능 평가</h3>

              <p>
                <strong>데이터셋</strong>: 124개 공격, 총 6,800만 트랜잭션<br />
                <strong>기간</strong>: 1,523일 (블록 5,470,817 ~ 15,000,000,
                2018.04.19 ~ 2022.06.21)
              </p>

              <figure class="table-container">
                <figcaption class="table__caption">탐지 결과</figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>데이터셋 크기</th>
                      <th>Top-1 탐지</th>
                      <th>Top-2 탐지</th>
                      <th>Top-3 탐지</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>1-99 txs</strong> (54%)</td>
                      <td>5 (7%)</td>
                      <td>8 (11%)</td>
                      <td>13 (18%)</td>
                    </tr>
                    <tr>
                      <td><strong>100-999 txs</strong> (33%)</td>
                      <td>8 (21%)</td>
                      <td>12 (32%)</td>
                      <td>28 (74%)</td>
                    </tr>
                    <tr>
                      <td><strong>1000-9999 txs</strong> (15%)</td>
                      <td>6 (35%)</td>
                      <td>9 (53%)</td>
                      <td>11 (65%)</td>
                    </tr>
                  </tbody>
                </table>
              </figure>

              <p>
                <strong>전체</strong>: 124개 공격 중
                <strong>49개(39.5%)를 Top-3 이상 트랜잭션</strong>으로 식별
              </p>
              <ul class="content__list">
                <li>Top-1: 20개</li>
                <li>Top-2: 20개</li>
                <li>Top-3: 7개</li>
              </ul>

              <p><strong>처리량:</strong></p>
              <ul class="content__list">
                <li>
                  <strong>평균 배치 처리량</strong>: 2,284 ± 289 트랜잭션/초
                </li>
                <li>
                  <strong>단일 트랜잭션 순위화 시간</strong>: 평균 0.16 ± 0.3초
                </li>
                <li><strong>실시간 IDS로서 활용 가능</strong></li>
              </ul>
            </section>

            <section id="section-2-4" class="report__subsection">
              <h3 class="subsection__title">2.4 강점과 한계</h3>

              <p><strong>강점:</strong></p>
              <ul class="content__list">
                <li>규칙 기반 휴리스틱에 의존하지 않음</li>
                <li>무제한 검색 공간으로 더 넓은 범위의 이상징후 탐지 가능</li>
                <li>실시간 처리 가능한 높은 처리량</li>
                <li>
                  스마트 컨트랙트 일시 정지 메커니즘 트리거 가능 (IPS로 활용)
                </li>
                <li>비지도/자기지도 학습 기반으로 레이블된 데이터 불필요</li>
              </ul>

              <p><strong>한계:</strong></p>
              <ul class="content__list">
                <li>BlockScan 대비 낮은 탐지 성능</li>
                <li>
                  지속적 저장소 읽기/쓰기 작업만 분석 (opcode 추적 분석 제외)
                </li>
                <li>인과적 모델로 미래 컨텍스트 고려 불가</li>
                <li>공식 코드 미공개 (저자 가이드 하 재구현 필요)</li>
                <li>Ethereum에만 초점, Solana 등 다른 체인 미지원</li>
              </ul>
            </section>
          </section>

          <hr />

          <!-- 섹션 3: AnoFormer -->
          <section id="section-3" class="report__section">
            <h2 class="section__title">
              <span class="section__number">3.</span> AnoFormer - Transformer
              기반 GAN 시계열 이상징후 탐지
            </h2>

            <section id="section-3-1" class="report__subsection">
              <h3 class="subsection__title">3.1 개요</h3>
              <p>
                AnoFormer는 <strong>NeurIPS 2022</strong>에 제출된
                <strong>범용 시계열 이상징후 탐지</strong> 모델입니다. 블록체인
                전용 모델이 아니라 ECG, 센서 데이터, 네트워크 트래픽 등 다양한
                시계열 데이터에 적용 가능한 프레임워크입니다.
              </p>

              <blockquote class="note">
                <p class="note__label">중요</p>
                <p class="note__content">
                  AnoFormer는 블록체인 트랜잭션 이상징후 탐지가 아닌
                  <strong>일반 시계열 이상징후 탐지</strong>를 위한 모델입니다.
                  그러나 블록체인 관련 시계열 데이터(예: 트랜잭션 볼륨, 가스
                  가격 시계열 등)에 적용 가능합니다.
                </p>
              </blockquote>
            </section>

            <section id="section-3-2" class="report__subsection">
              <h3 class="subsection__title">3.2 핵심 기술적 혁신</h3>

              <section id="section-3-2-1" class="report__subsubsection">
                <h4 class="subsubsection__title">
                  3.2.1 Transformer 기반 GAN 프레임워크
                </h4>
                <p>
                  AnoFormer는 순수 Transformer 인코더만을 사용하는 GAN
                  프레임워크입니다:
                </p>

                <figure class="code-block">
                  <figcaption class="code__caption">
                    GAN 프레임워크 구조
                  </figcaption>
                  <pre
                    class="code__pre"
                  ><code class="code__content">[Generator G]: Transformer Encoder
    - 입력 신호를 정상과 유사한 신호로 재구성

[Critic C]: Transformer Encoder + Linear Classifier
    - WGAN-GP 기반 적대적 학습
    - 생성된 출력의 품질 향상 유도</code></pre>
                </figure>
              </section>

              <section id="section-3-2-2" class="report__subsubsection">
                <h4 class="subsubsection__title">
                  3.2.2 Two-Step Masking 전략
                </h4>
                <p>
                  AnoFormer의 핵심 혁신은
                  <strong>Two-Step Masking</strong> 전략입니다:
                </p>

                <p><strong>Step 1: Random Masking</strong></p>
                <figure class="code-block">
                  <figcaption class="code__caption">
                    Step 1: Random Masking
                  </figcaption>
                  <pre
                    class="code__pre"
                  ><code class="code__content">- 미리 정의된 마스크 풀에서 랜덤 선택
- 마스크/비마스크 섹션이 교대로 나타나는 단일 마스크 설계
- 슬라이딩 윈도우로 다중 마스크 생성
- Generator가 마스킹된 부분을 재구성하며 정상 데이터 분포 학습</code></pre>
                </figure>

                <p>
                  <strong>Step 2: Exclusive + Entropy-based Re-Masking</strong>
                </p>
                <figure class="code-block">
                  <figcaption class="code__caption">
                    Step 2: Entropy-based Re-Masking
                  </figcaption>
                  <pre
                    class="code__pre"
                  ><code class="code__content">- Step 1에서 커버되지 않은 배타적 부분 재마스킹
- 어텐션 맵에서 엔트로피 계산
- 높은 엔트로피 = 균일 분포된 어텐션 = 불확실한 예측
- 높은 엔트로피 부분 재마스킹으로 피드백 제공
- 최종 출력 = Step 1 마스킹 부분 + Step 2 마스킹 부분 결합</code></pre>
                </figure>
              </section>

              <section id="section-3-2-3" class="report__subsubsection">
                <h4 class="subsubsection__title">3.2.3 전처리 및 임베딩</h4>

                <figure class="code-block code-block--python">
                  <figcaption class="code__caption">
                    전처리 및 임베딩 코드
                  </figcaption>
                  <pre class="code__pre"><code class="code__content"># 전처리
X_norm = min_max_scaling(X, [-1, 1])  # 정규화
X_quant = quantize(X_norm, K=400)     # 양자화 (K=400 토큰)

# 임베딩
z' = embedding_table[X_quant]         # 토큰 임베딩
z = z' + positional_embedding         # 위치 임베딩 추가

# 역임베딩 (Inverse Embedding)
p = softmax(cosine_similarity(z_hat, W_e))  # 확률 분포
X_hat = soft_argmax(p)                       # 재구성</code></pre>
                </figure>
              </section>
            </section>

            <section id="section-3-3" class="report__subsection">
              <h3 class="subsection__title">3.3 성능 평가</h3>

              <figure class="table-container">
                <figcaption class="table__caption">
                  벤치마크 데이터셋 결과 (AUROC)
                </figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>데이터셋</th>
                      <th>AnoFormer</th>
                      <th>Anomaly Transformer</th>
                      <th>TadGAN</th>
                      <th>BeatGAN</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>NeurIPS-TS (평균)</strong></td>
                      <td><span class="highlight">0.9911</span></td>
                      <td>0.8400</td>
                      <td>0.9726</td>
                      <td>0.8372</td>
                    </tr>
                    <tr>
                      <td><strong>MIT-BIH</strong></td>
                      <td><span class="highlight">0.9552</span></td>
                      <td>0.8108</td>
                      <td>0.8256</td>
                      <td>0.9475</td>
                    </tr>
                    <tr>
                      <td><strong>2D-gesture</strong></td>
                      <td><span class="highlight">0.8407</span></td>
                      <td>0.7868</td>
                      <td>0.5294</td>
                      <td>0.7256</td>
                    </tr>
                    <tr>
                      <td><strong>Power-demand</strong></td>
                      <td><span class="highlight">0.8667</span></td>
                      <td>0.7739</td>
                      <td>0.8438</td>
                      <td>0.5796</td>
                    </tr>
                  </tbody>
                </table>
              </figure>

              <figure class="table-container">
                <figcaption class="table__caption">
                  NeurIPS-TS 세부 결과 (AUROC)
                </figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>이상 유형</th>
                      <th>AnoFormer</th>
                      <th>Anomaly Transformer</th>
                      <th>TadGAN</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Global</td>
                      <td>1.0000</td>
                      <td>0.9931</td>
                      <td>1.0000</td>
                    </tr>
                    <tr>
                      <td>Contextual</td>
                      <td><span class="highlight">0.9758</span></td>
                      <td>0.6224</td>
                      <td>0.4285</td>
                    </tr>
                    <tr>
                      <td>Shapelet</td>
                      <td><span class="highlight">0.9900</span></td>
                      <td>0.7407</td>
                      <td>0.9834</td>
                    </tr>
                    <tr>
                      <td>Seasonal</td>
                      <td><span class="highlight">0.9985</span></td>
                      <td>0.9332</td>
                      <td>0.9744</td>
                    </tr>
                    <tr>
                      <td>Trend</td>
                      <td><span class="highlight">0.9985</span></td>
                      <td>0.9976</td>
                      <td>0.9327</td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </section>

            <section id="section-3-4" class="report__subsection">
              <h3 class="subsection__title">3.4 블록체인 적용 가능성</h3>
              <p>
                AnoFormer는 블록체인 전용 모델이 아니지만, 다음과 같은 블록체인
                관련 시계열 데이터에 적용 가능합니다:
              </p>
              <ul class="content__list">
                <li>
                  <strong>체인 레벨 시계열</strong>: 총 트랜잭션 볼륨/시간, 평균
                  가스 가격, 스마트 컨트랙트 생성률
                </li>
                <li>
                  <strong>DeFi 시계열</strong>: TVL(Total Value Locked) 변화,
                  유동성 풀 변동, 토큰 가격 시계열
                </li>
                <li>
                  <strong>네트워크 시계열</strong>: 활성 주소 수, 새 지갑
                  생성률, 특정 이벤트 빈도
                </li>
              </ul>
            </section>

            <section id="section-3-5" class="report__subsection">
              <h3 class="subsection__title">3.5 강점과 한계</h3>

              <p><strong>강점:</strong></p>
              <ul class="content__list">
                <li>다양한 시계열 데이터에 범용 적용 가능</li>
                <li>Two-Step Masking으로 강건한 정상 데이터 표현 학습</li>
                <li>엔트로피 기반 피드백으로 불확실한 부분 개선</li>
                <li>레이블 없는 비지도 학습</li>
                <li>State-of-the-art 성능 달성</li>
              </ul>

              <p><strong>한계:</strong></p>
              <ul class="content__list">
                <li>블록체인 트랜잭션의 구조적 특성 미고려</li>
                <li>개별 트랜잭션 내부 구조 분석 불가</li>
                <li>멀티모달 블록체인 데이터 처리 기능 없음</li>
              </ul>
            </section>
          </section>

          <hr />

          <!-- 섹션 4: 종합 비교 분석 -->
          <section id="section-4" class="report__section">
            <h2 class="section__title">
              <span class="section__number">4.</span> 종합 비교 분석
            </h2>

            <section id="section-4-1" class="report__subsection">
              <h3 class="subsection__title">4.1 기술적 비교</h3>

              <figure class="table-container">
                <figcaption class="table__caption">기술적 특성 비교</figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>특성</th>
                      <th>BlockScan</th>
                      <th>BlockGPT</th>
                      <th>AnoFormer</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>기반 아키텍처</strong></td>
                      <td>RoBERTa + RoPE + FlashAttention</td>
                      <td>GPT (Causal Transformer)</td>
                      <td>Transformer-GAN</td>
                    </tr>
                    <tr>
                      <td><strong>학습 방식</strong></td>
                      <td>Masked Language Modeling</td>
                      <td>Next Token Prediction</td>
                      <td>Adversarial + Reconstruction</td>
                    </tr>
                    <tr>
                      <td><strong>대상 데이터</strong></td>
                      <td>블록체인 트랜잭션</td>
                      <td>블록체인 트랜잭션</td>
                      <td>범용 시계열</td>
                    </tr>
                    <tr>
                      <td><strong>지원 체인</strong></td>
                      <td>Ethereum, Solana</td>
                      <td>Ethereum</td>
                      <td>N/A</td>
                    </tr>
                    <tr>
                      <td><strong>토크나이저</strong></td>
                      <td>커스텀 모듈화</td>
                      <td>도메인 특화</td>
                      <td>양자화 기반</td>
                    </tr>
                    <tr>
                      <td><strong>실시간 처리</strong></td>
                      <td>미명시</td>
                      <td>2,284 tx/s</td>
                      <td>미명시</td>
                    </tr>
                    <tr>
                      <td><strong>오픈소스</strong></td>
                      <td>예</td>
                      <td>아니오</td>
                      <td>미명시</td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </section>

            <section id="section-4-2" class="report__subsection">
              <h3 class="subsection__title">4.2 탐지 능력 비교</h3>

              <figure class="table-container">
                <figcaption class="table__caption">탐지 능력 비교</figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>측면</th>
                      <th>BlockScan</th>
                      <th>BlockGPT</th>
                      <th>AnoFormer</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>Ethereum 탐지</strong></td>
                      <td><span class="highlight">우수 (80% Recall)</span></td>
                      <td>보통 (27.78% Recall)</td>
                      <td>N/A</td>
                    </tr>
                    <tr>
                      <td><strong>Solana 탐지</strong></td>
                      <td>
                        <span class="highlight">우수 (72.22% Recall)</span>
                      </td>
                      <td>미지원</td>
                      <td>N/A</td>
                    </tr>
                    <tr>
                      <td><strong>FPR</strong></td>
                      <td><span class="highlight">최저 (0.28%)</span></td>
                      <td>높음 (1.0%)</td>
                      <td>N/A</td>
                    </tr>
                    <tr>
                      <td><strong>시계열 이상징후</strong></td>
                      <td>미지원</td>
                      <td>미지원</td>
                      <td><span class="highlight">우수 (0.99 AUROC)</span></td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </section>

            <section id="section-4-3" class="report__subsection">
              <h3 class="subsection__title">4.3 적용 시나리오별 권장</h3>

              <figure class="table-container">
                <figcaption class="table__caption">
                  시나리오별 권장 모델
                </figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>시나리오</th>
                      <th>권장 모델</th>
                      <th>이유</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>개별 트랜잭션 이상 탐지</strong></td>
                      <td>BlockScan</td>
                      <td>최고 정확도, 다중 체인 지원</td>
                    </tr>
                    <tr>
                      <td><strong>실시간 DeFi 침입 탐지</strong></td>
                      <td>BlockGPT</td>
                      <td>높은 처리량, IDS/IPS 통합 가능</td>
                    </tr>
                    <tr>
                      <td><strong>체인 레벨 시계열 모니터링</strong></td>
                      <td>AnoFormer</td>
                      <td>시계열 특화, 다양한 이상 유형 탐지</td>
                    </tr>
                    <tr>
                      <td><strong>Solana 트랜잭션 분석</strong></td>
                      <td>BlockScan</td>
                      <td>유일하게 Solana 지원하며 높은 성능</td>
                    </tr>
                    <tr>
                      <td><strong>신규 공격 유형 탐지</strong></td>
                      <td>BlockGPT</td>
                      <td>규칙 없는 비지도 학습</td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </section>

            <section id="section-4-4" class="report__subsection">
              <h3 class="subsection__title">4.4 이상징후 탐지 관점 분류</h3>
              <p>블록체인 이상징후 탐지는 크게 두 가지 레벨로 분류됩니다:</p>

              <h4 class="subsubsection__title">
                Level 1: 트랜잭션 내 이상징후 탐지 (Intra-Transaction)
              </h4>
              <ul class="content__list">
                <li>
                  단일 트랜잭션 내부 구조 분석 (함수 호출, 파라미터, 로그, 주소)
                </li>
                <li>
                  <strong>BlockScan</strong>, <strong>BlockGPT</strong> 해당
                </li>
                <li>플래시론 공격, 재진입 공격, 조작된 오라클 등 탐지</li>
              </ul>

              <h4 class="subsubsection__title">
                Level 2: 체인 레벨 시간적 이상징후 탐지 (Chain-level Temporal)
              </h4>
              <ul class="content__list">
                <li>네트워크 전체 통계 및 시계열 분석</li>
                <li>총 트랜잭션 볼륨, 평균 가스 가격, 특정 이벤트 빈도 등</li>
                <li><strong>AnoFormer</strong> 적용 가능</li>
                <li>갑작스러운 이상 패턴, 시장 조작 등 탐지</li>
              </ul>
            </section>
          </section>

          <hr />

          <!-- 섹션 5: 결론 및 권장사항 -->
          <section id="section-5" class="report__section">
            <h2 class="section__title">
              <span class="section__number">5.</span> 결론 및 권장사항
            </h2>

            <section id="section-5-1" class="report__subsection">
              <h3 class="subsection__title">5.1 핵심 결론</h3>

              <div class="key-findings">
                <div class="key-finding__card">
                  <h4 class="key-finding__title">BlockScan</h4>
                  <p class="key-finding__content">
                    현재 블록체인 트랜잭션 이상징후 탐지에서
                    <strong>최고의 성능</strong>을 보이며, 특히 Solana를 포함한
                    다중 체인 지원이 독보적입니다.
                  </p>
                </div>
                <div class="key-finding__card">
                  <h4 class="key-finding__title">BlockGPT</h4>
                  <p class="key-finding__content">
                    실시간 침입 탐지 시스템으로서 가치가 있으나, 탐지 정확도
                    면에서 BlockScan에 뒤처집니다. 규칙 기반 시스템 없이
                    자동으로 이상징후를 학습하는 선구적 연구입니다.
                  </p>
                </div>
                <div class="key-finding__card">
                  <h4 class="key-finding__title">AnoFormer</h4>
                  <p class="key-finding__content">
                    <strong>블록체인 전용 모델이 아니며</strong>, 범용 시계열
                    이상징후 탐지에 특화되어 있습니다. 블록체인 관련 시계열
                    데이터에는 적용 가능하지만, 개별 트랜잭션 분석에는
                    부적합합니다.
                  </p>
                </div>
              </div>
            </section>

            <section id="section-5-2" class="report__subsection">
              <h3 class="subsection__title">5.2 권장사항</h3>

              <figure class="table-container">
                <figcaption class="table__caption">
                  목적별 권장 접근 방식
                </figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>목적</th>
                      <th>권장 접근 방식</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>프로덕션 환경 이상 탐지</strong></td>
                      <td>BlockScan 도입 우선 고려</td>
                    </tr>
                    <tr>
                      <td><strong>실시간 모니터링 시스템</strong></td>
                      <td>BlockGPT 기반 IDS 구축</td>
                    </tr>
                    <tr>
                      <td><strong>체인 헬스 모니터링</strong></td>
                      <td>AnoFormer로 체인 레벨 시계열 분석</td>
                    </tr>
                    <tr>
                      <td><strong>연구 목적</strong></td>
                      <td>BlockScan 코드베이스 활용 (오픈소스)</td>
                    </tr>
                    <tr>
                      <td><strong>멀티 체인 지원 필요</strong></td>
                      <td>BlockScan (Ethereum + Solana)</td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </section>

            <section id="section-5-3" class="report__subsection">
              <h3 class="subsection__title">5.3 향후 연구 방향</h3>
              <ol class="content__list">
                <li>
                  <strong>멀티모달 통합</strong>: 온체인 데이터와 오프체인
                  데이터 결합 분석
                </li>
                <li>
                  <strong>크로스체인 이상징후</strong>: 브릿지 및 크로스체인
                  트랜잭션 이상 탐지
                </li>
                <li>
                  <strong>설명 가능성</strong>: Transformer 기반 모델의 해석
                  가능성 향상
                </li>
                <li>
                  <strong>실시간 대응</strong>: 이상 탐지 → 자동 대응 파이프라인
                  구축
                </li>
              </ol>
            </section>
          </section>

          <hr />

          <!-- 섹션 6: 학습 데이터셋 -->
          <section id="section-6" class="report__section">
            <h2 class="section__title">
              <span class="section__number">6.</span> 학습 데이터셋
            </h2>

            <p>
              이 섹션에서는 BlockScan 모델 훈련에 사용된 Ethereum 트랜잭션 트레이스
              데이터셋을 상세히 분석합니다. 데이터셋은 5개 프로토콜의 41,711개
              트랜잭션으로 구성되며, 4건의 실제 보안 사고와 1개의 참조 데이터셋을
              포함합니다.
            </p>

            <section id="section-6-1" class="report__subsection">
              <h3 class="subsection__title">6.1 데이터셋 개요</h3>

              <div class="key-findings">
                <div class="key-finding__card">
                  <h4 class="key-finding__title">총 트랜잭션</h4>
                  <p class="key-finding__content">
                    <strong style="font-size: 1.5rem">41,711</strong>건
                  </p>
                </div>
                <div class="key-finding__card">
                  <h4 class="key-finding__title">데이터 크기</h4>
                  <p class="key-finding__content">
                    <strong style="font-size: 1.5rem">706.4</strong> MB
                  </p>
                </div>
                <div class="key-finding__card">
                  <h4 class="key-finding__title">분석 프로젝트</h4>
                  <p class="key-finding__content">
                    <strong style="font-size: 1.5rem">5</strong>개
                  </p>
                </div>
                <div class="key-finding__card">
                  <h4 class="key-finding__title">악성 트랜잭션</h4>
                  <p class="key-finding__content">
                    <strong style="font-size: 1.5rem">10</strong>건 (0.02%)
                  </p>
                </div>
              </div>

              <figure class="table-container">
                <figcaption class="table__caption">
                  프로젝트별 트랜잭션 분포
                </figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>프로젝트</th>
                      <th>파일 수</th>
                      <th>비율</th>
                      <th>크기</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>TrustSwap</strong></td>
                      <td>30,146</td>
                      <td>72.3%</td>
                      <td>372.2 MB</td>
                    </tr>
                    <tr>
                      <td><strong>NomadBridge</strong></td>
                      <td>10,460</td>
                      <td>25.1%</td>
                      <td>312.8 MB</td>
                    </tr>
                    <tr>
                      <td><strong>AudiusProject</strong></td>
                      <td>876</td>
                      <td>2.1%</td>
                      <td>13.5 MB</td>
                    </tr>
                    <tr>
                      <td><strong>SushiSwap</strong></td>
                      <td>206</td>
                      <td>0.5%</td>
                      <td>4.0 MB</td>
                    </tr>
                    <tr>
                      <td><strong>ShataCapital</strong></td>
                      <td>23</td>
                      <td>0.05%</td>
                      <td>3.9 MB</td>
                    </tr>
                  </tbody>
                </table>
              </figure>

              <figure class="image-container">
                <img
                  src="data/docs/figures/distribution_by_project.png"
                  alt="프로젝트별 트랜잭션 분포를 보여주는 막대 그래프"
                  loading="lazy"
                />
                <figcaption class="image__caption">
                  프로젝트별 트랜잭션 분포
                </figcaption>
              </figure>

              <figure class="table-container">
                <figcaption class="table__caption">레이블별 분포</figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>레이블</th>
                      <th>개수</th>
                      <th>비율</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>정상 (Benign)</strong></td>
                      <td>38,023</td>
                      <td>91.2%</td>
                    </tr>
                    <tr>
                      <td><strong>제외 (Excluded)</strong></td>
                      <td>3,678</td>
                      <td>8.8%</td>
                    </tr>
                    <tr>
                      <td><strong>악성 (Malicious)</strong></td>
                      <td>10</td>
                      <td>0.02%</td>
                    </tr>
                  </tbody>
                </table>
              </figure>

              <figure class="image-container">
                <img
                  src="data/docs/figures/distribution_by_label.png"
                  alt="레이블별 트랜잭션 분포를 보여주는 차트"
                  loading="lazy"
                />
                <figcaption class="image__caption">레이블별 분포</figcaption>
              </figure>

              <figure class="table-container">
                <figcaption class="table__caption">
                  프로젝트별 레이블 분포
                </figcaption>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>프로젝트</th>
                      <th>정상</th>
                      <th>악성</th>
                      <th>제외</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>NomadBridge</strong></td>
                      <td>9,915</td>
                      <td><span class="highlight-warning">4</span></td>
                      <td>541</td>
                    </tr>
                    <tr>
                      <td><strong>TrustSwap</strong></td>
                      <td>27,024</td>
                      <td>0</td>
                      <td>3,122</td>
                    </tr>
                    <tr>
                      <td><strong>AudiusProject</strong></td>
                      <td>865</td>
                      <td><span class="highlight-warning">2</span></td>
                      <td>9</td>
                    </tr>
                    <tr>
                      <td><strong>SushiSwap</strong></td>
                      <td>199</td>
                      <td><span class="highlight-warning">2</span></td>
                      <td>5</td>
                    </tr>
                    <tr>
                      <td><strong>ShataCapital</strong></td>
                      <td>20</td>
                      <td><span class="highlight-warning">2</span></td>
                      <td>1</td>
                    </tr>
                  </tbody>
                </table>
              </figure>

              <blockquote class="note">
                <p class="note__label">클래스 불균형 주의</p>
                <p class="note__content">
                  데이터셋은 극심한 클래스 불균형을 보입니다. 악성 트랜잭션은
                  전체의 0.02% (10건)에 불과하며, 이는 실제 블록체인 환경을
                  반영합니다. ML 모델 훈련 시 이 불균형을 고려한 전략이
                  필요합니다.
                </p>
              </blockquote>
            </section>

            <section id="section-6-2" class="report__subsection">
              <h3 class="subsection__title">6.2 데이터 분석</h3>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">파일 크기 분포</h4>

                <figure class="table-container">
                  <figcaption class="table__caption">
                    파일 크기 통계 요약
                  </figcaption>
                  <table class="data-table data-table--metrics">
                    <thead>
                      <tr>
                        <th>메트릭</th>
                        <th>값</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>최소</strong></td>
                        <td>~1 KB</td>
                      </tr>
                      <tr>
                        <td><strong>최대</strong></td>
                        <td>~500+ KB</td>
                      </tr>
                      <tr>
                        <td><strong>평균</strong></td>
                        <td>~17 KB</td>
                      </tr>
                      <tr>
                        <td><strong>중앙값</strong></td>
                        <td>~10 KB</td>
                      </tr>
                      <tr>
                        <td><strong>표준편차</strong></td>
                        <td>~25 KB</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <figure class="image-container">
                  <img
                    src="data/docs/figures/file_size_histogram.png"
                    alt="파일 크기 분포 히스토그램"
                    loading="lazy"
                  />
                  <figcaption class="image__caption">
                    파일 크기 분포 (우측으로 치우친 분포)
                  </figcaption>
                </figure>

                <p>
                  파일 크기는 우측으로 치우친 분포를 보입니다. 대부분의 트랜잭션은
                  상대적으로 작지만, 복잡한 트랜잭션(특히 익스플로잇)은 상당히 큰
                  트레이스를 생성합니다.
                </p>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">콜 깊이 분석</h4>

                <figure class="table-container">
                  <figcaption class="table__caption">
                    프로젝트별 콜 깊이
                  </figcaption>
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th>프로젝트</th>
                        <th>평균 깊이</th>
                        <th>최대 깊이</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>NomadBridge</strong></td>
                        <td>4.2</td>
                        <td>12</td>
                      </tr>
                      <tr>
                        <td><strong>TrustSwap</strong></td>
                        <td>3.1</td>
                        <td>8</td>
                      </tr>
                      <tr>
                        <td><strong>AudiusProject</strong></td>
                        <td>5.8</td>
                        <td>15</td>
                      </tr>
                      <tr>
                        <td><strong>SushiSwap</strong></td>
                        <td>4.5</td>
                        <td>10</td>
                      </tr>
                      <tr>
                        <td><strong>ShataCapital</strong></td>
                        <td>6.2</td>
                        <td>14</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <figure class="image-container">
                  <img
                    src="data/docs/figures/call_depth_boxplot.png"
                    alt="프로젝트별 콜 깊이 박스플롯"
                    loading="lazy"
                  />
                  <figcaption class="image__caption">
                    프로젝트별 콜 깊이 분석
                  </figcaption>
                </figure>

                <p>
                  프록시 패턴을 사용하는 프로토콜(Audius, Shata)은 delegate call
                  체인으로 인해 더 깊은 콜 스택을 보입니다.
                </p>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">콜 타입 분포</h4>

                <figure class="table-container">
                  <figcaption class="table__caption">EVM 콜 타입별 분포</figcaption>
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th>콜 타입</th>
                        <th>비율</th>
                        <th>설명</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>CALL</strong></td>
                        <td>~60%</td>
                        <td>외부 호출</td>
                      </tr>
                      <tr>
                        <td><strong>STATICCALL</strong></td>
                        <td>~25%</td>
                        <td>읽기 전용 쿼리</td>
                      </tr>
                      <tr>
                        <td><strong>DELEGATECALL</strong></td>
                        <td>~12%</td>
                        <td>프록시 패턴 호출</td>
                      </tr>
                      <tr>
                        <td><strong>CREATE</strong></td>
                        <td>~2%</td>
                        <td>컨트랙트 배포</td>
                      </tr>
                      <tr>
                        <td><strong>CREATE2</strong></td>
                        <td>~1%</td>
                        <td>결정적 주소 배포</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <figure class="image-container">
                  <img
                    src="data/docs/figures/call_type_donut.png"
                    alt="콜 타입 분포 도넛 차트"
                    loading="lazy"
                  />
                  <figcaption class="image__caption">
                    콜 타입 분포
                  </figcaption>
                </figure>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">가스 사용량 분석</h4>

                <figure class="table-container">
                  <figcaption class="table__caption">
                    정상 vs 악성 트랜잭션 가스 비교
                  </figcaption>
                  <table class="data-table data-table--metrics">
                    <thead>
                      <tr>
                        <th>카테고리</th>
                        <th>평균 가스</th>
                        <th>중앙값 가스</th>
                        <th>최대 가스</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>정상</strong></td>
                        <td>~150,000</td>
                        <td>~120,000</td>
                        <td>~500,000</td>
                      </tr>
                      <tr>
                        <td><strong>악성</strong></td>
                        <td><span class="highlight-warning">~250,000</span></td>
                        <td><span class="highlight-warning">~200,000</span></td>
                        <td><span class="highlight-warning">~800,000</span></td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <figure class="image-container">
                  <img
                    src="data/docs/figures/gas_comparison.png"
                    alt="정상 vs 악성 트랜잭션 가스 사용량 비교 차트"
                    loading="lazy"
                  />
                  <figcaption class="image__caption">
                    정상 vs 악성 트랜잭션 가스 사용량 비교
                  </figcaption>
                </figure>

                <blockquote class="theorem">
                  <p class="theorem__label"><strong>핵심 발견</strong></p>
                  <p class="theorem__content">
                    악성 트랜잭션은 복잡한 익스플로잇 로직과 다중 내부 호출로 인해
                    정상 트랜잭션보다 1.5~2배 더 많은 가스를 소비합니다. 이는
                    이상징후 탐지에 중요한 피처가 될 수 있습니다.
                  </p>
                </blockquote>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">프로젝트별 데이터 크기</h4>

                <figure class="table-container">
                  <figcaption class="table__caption">
                    프로젝트별 데이터 크기 비교
                  </figcaption>
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th>프로젝트</th>
                        <th>크기 (MB)</th>
                        <th>평균 파일 크기 (KB)</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>TrustSwap</strong></td>
                        <td>372.2</td>
                        <td>12.3</td>
                      </tr>
                      <tr>
                        <td><strong>NomadBridge</strong></td>
                        <td>312.8</td>
                        <td>29.9</td>
                      </tr>
                      <tr>
                        <td><strong>AudiusProject</strong></td>
                        <td>13.5</td>
                        <td>15.4</td>
                      </tr>
                      <tr>
                        <td><strong>SushiSwap</strong></td>
                        <td>4.0</td>
                        <td>19.4</td>
                      </tr>
                      <tr>
                        <td><strong>ShataCapital</strong></td>
                        <td>3.9</td>
                        <td>169.6</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <figure class="image-container">
                  <img
                    src="data/docs/figures/project_size_comparison.png"
                    alt="프로젝트별 데이터 크기 비교 차트"
                    loading="lazy"
                  />
                  <figcaption class="image__caption">
                    프로젝트별 데이터 크기 비교
                  </figcaption>
                </figure>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">스토리지 연산 분포</h4>

                <figure class="table-container">
                  <figcaption class="table__caption">
                    READ vs WRITE 연산 비율
                  </figcaption>
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th>연산</th>
                        <th>비율</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>READ</strong></td>
                        <td>~85%</td>
                      </tr>
                      <tr>
                        <td><strong>WRITE</strong></td>
                        <td>~15%</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <p>
                  대부분의 트랜잭션은 읽기 위주입니다. WRITE 연산은 악성
                  트랜잭션에서 더 빈번하게 나타나며, 특히 중요한 상태 변수 수정이
                  포함됩니다.
                </p>
              </section>
            </section>

            <section id="section-6-3" class="report__subsection">
              <h3 class="subsection__title">6.3 JSON 스키마</h3>

              <p>
                각 트랜잭션 트레이스는 JSON 형식으로 저장됩니다. 파일명은
                <code>&lt;block_number&gt;-&lt;transaction_index&gt;.json</code>
                형식을 따릅니다.
              </p>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">루트 구조</h4>

                <figure class="code-block code-block--json">
                  <figcaption class="code__caption">JSON 루트 구조</figcaption>
                  <pre class="code__pre"><code class="code__content">{
  "&lt;transaction_hash&gt;": [&lt;call_object&gt;, ...]
}</code></pre>
                </figure>

                <ul class="content__list">
                  <li>
                    <strong>Key</strong>: 전체 트랜잭션 해시 (0x 접두사 포함, 66자)
                  </li>
                  <li>
                    <strong>Value</strong>: 루트 레벨 콜 객체 배열 (일반적으로 1개)
                  </li>
                </ul>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">Call 객체</h4>

                <figure class="code-block code-block--json">
                  <figcaption class="code__caption">Call 객체 구조</figcaption>
                  <pre class="code__pre"><code class="code__content">{
  "type": "CALL",
  "from": "0x...",
  "to": "0x...",
  "gas": 349591,
  "gasUsed": 263706,
  "func": "0x37c8f01a",
  "args": [...],
  "argsNotParsed": false,
  "output": [...],
  "calls": [...],
  "logs": [...],
  "state": [...],
  "value": 0.0
}</code></pre>
                </figure>

                <figure class="table-container">
                  <figcaption class="table__caption">
                    Call 객체 필드 참조
                  </figcaption>
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th>필드</th>
                        <th>타입</th>
                        <th>필수</th>
                        <th>설명</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><code>type</code></td>
                        <td>string</td>
                        <td>예</td>
                        <td>콜 opcode 타입</td>
                      </tr>
                      <tr>
                        <td><code>from</code></td>
                        <td>string</td>
                        <td>예</td>
                        <td>발신자 주소</td>
                      </tr>
                      <tr>
                        <td><code>to</code></td>
                        <td>string</td>
                        <td>예</td>
                        <td>수신자 주소</td>
                      </tr>
                      <tr>
                        <td><code>gas</code></td>
                        <td>integer</td>
                        <td>예</td>
                        <td>가스 한도</td>
                      </tr>
                      <tr>
                        <td><code>gasUsed</code></td>
                        <td>integer</td>
                        <td>예</td>
                        <td>실제 소비된 가스</td>
                      </tr>
                      <tr>
                        <td><code>func</code></td>
                        <td>string|null</td>
                        <td>아니오</td>
                        <td>함수 셀렉터 (4바이트)</td>
                      </tr>
                      <tr>
                        <td><code>args</code></td>
                        <td>array|null</td>
                        <td>아니오</td>
                        <td>디코딩된 함수 인자</td>
                      </tr>
                      <tr>
                        <td><code>output</code></td>
                        <td>array|null</td>
                        <td>아니오</td>
                        <td>반환 값</td>
                      </tr>
                      <tr>
                        <td><code>calls</code></td>
                        <td>array|null</td>
                        <td>아니오</td>
                        <td>중첩된 내부 콜 (재귀적)</td>
                      </tr>
                      <tr>
                        <td><code>logs</code></td>
                        <td>array|null</td>
                        <td>아니오</td>
                        <td>발생된 이벤트 로그</td>
                      </tr>
                      <tr>
                        <td><code>state</code></td>
                        <td>array|null</td>
                        <td>아니오</td>
                        <td>스토리지 연산</td>
                      </tr>
                      <tr>
                        <td><code>value</code></td>
                        <td>number|null</td>
                        <td>아니오</td>
                        <td>전송된 ETH (ETH 단위)</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">콜 타입</h4>

                <figure class="table-container">
                  <figcaption class="table__caption">EVM 콜 타입 설명</figcaption>
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th>타입</th>
                        <th>설명</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><code>CALL</code></td>
                        <td>표준 외부 호출, ETH 전송 가능</td>
                      </tr>
                      <tr>
                        <td><code>STATICCALL</code></td>
                        <td>읽기 전용 호출, 상태 변경 불가</td>
                      </tr>
                      <tr>
                        <td><code>DELEGATECALL</code></td>
                        <td>호출자의 컨텍스트에서 코드 실행</td>
                      </tr>
                      <tr>
                        <td><code>CALLCODE</code></td>
                        <td>DELEGATECALL의 레거시 버전</td>
                      </tr>
                      <tr>
                        <td><code>CREATE</code></td>
                        <td>새 컨트랙트 배포</td>
                      </tr>
                      <tr>
                        <td><code>CREATE2</code></td>
                        <td>결정적 주소로 컨트랙트 배포</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">State 객체</h4>

                <figure class="code-block code-block--json">
                  <figcaption class="code__caption">
                    스토리지 연산 구조
                  </figcaption>
                  <pre class="code__pre"><code class="code__content">{
  "type": "READ",
  "address": "0x2260fac5e5542a773aa44fbcfedf7c193bc2c599",
  "key": "0xcb35f6ffed66be2678de421a2bf25c9b321b46e17ebb4f1b5cb2fc9dfee70e8e",
  "value": "0x17f0da170f"
}</code></pre>
                </figure>

                <figure class="table-container">
                  <figcaption class="table__caption">State 필드 참조</figcaption>
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th>필드</th>
                        <th>타입</th>
                        <th>설명</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><code>type</code></td>
                        <td>string</td>
                        <td><code>READ</code> 또는 <code>WRITE</code></td>
                      </tr>
                      <tr>
                        <td><code>address</code></td>
                        <td>string</td>
                        <td>접근 중인 컨트랙트 스토리지</td>
                      </tr>
                      <tr>
                        <td><code>key</code></td>
                        <td>string</td>
                        <td>스토리지 슬롯 (32바이트)</td>
                      </tr>
                      <tr>
                        <td><code>value</code></td>
                        <td>string</td>
                        <td>읽거나 쓴 값</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">Log 객체</h4>

                <figure class="code-block code-block--json">
                  <figcaption class="code__caption">이벤트 로그 구조</figcaption>
                  <pre class="code__pre"><code class="code__content">{
  "address": "0x2260fac5e5542a773aa44fbcfedf7c193bc2c599",
  "topics": [
    {"type": "data", "data": "0xddf252ad..."},
    {"type": "address", "data": "0x88A69B4E..."},
    {"type": "address", "data": "0xf57113D8..."}
  ],
  "data": [
    {"type": "data", "data": "0x00000000...02540be400"}
  ]
}</code></pre>
                </figure>

                <p>
                  <strong>일반적인 이벤트 시그니처</strong>:
                </p>
                <ul class="content__list">
                  <li>
                    <code>Transfer(address,address,uint256)</code>: ~45%
                  </li>
                  <li>
                    <code>Approval(address,address,uint256)</code>: ~20%
                  </li>
                  <li>
                    <code>Swap(...)</code> (Uniswap V2): ~15%
                  </li>
                  <li>
                    <code>Deposit</code>: ~10%
                  </li>
                </ul>
              </section>
            </section>

            <section id="section-6-4" class="report__subsection">
              <h3 class="subsection__title">6.4 보안 사고 분석</h3>

              <p>
                데이터셋에는 4건의 실제 DeFi 보안 사고가 포함되어 있습니다. 각
                사고의 악성 트랜잭션은 이상징후 탐지 모델 평가에 사용됩니다.
              </p>

              <div class="incident-summary">
                <div class="incident-card incident-card--danger">
                  <h4 class="incident-card__title">Nomad Bridge</h4>
                  <p class="incident-card__value">$1.9억</p>
                  <p class="incident-card__label">2022년 8월</p>
                </div>
                <div class="incident-card incident-card--danger">
                  <h4 class="incident-card__title">Audius</h4>
                  <p class="incident-card__value">$600만</p>
                  <p class="incident-card__label">2022년 7월</p>
                </div>
                <div class="incident-card incident-card--danger">
                  <h4 class="incident-card__title">SushiSwap</h4>
                  <p class="incident-card__value">$330만</p>
                  <p class="incident-card__label">2023년 4월</p>
                </div>
                <div class="incident-card incident-card--danger">
                  <h4 class="incident-card__title">Shata Capital</h4>
                  <p class="incident-card__value">$514만</p>
                  <p class="incident-card__label">2023년 2월</p>
                </div>
                <div class="incident-card incident-card--safe">
                  <h4 class="incident-card__title">TrustSwap</h4>
                  <p class="incident-card__value">참조</p>
                  <p class="incident-card__label">정상 베이스라인</p>
                </div>
              </div>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">
                  6.4.1 Nomad Bridge (2022년 8월)
                </h4>

                <figure class="table-container">
                  <figcaption class="table__caption">사고 개요</figcaption>
                  <table class="data-table data-table--metrics">
                    <tbody>
                      <tr>
                        <td><strong>발생일</strong></td>
                        <td>2022년 8월 1일</td>
                      </tr>
                      <tr>
                        <td><strong>피해 규모</strong></td>
                        <td>
                          <span class="highlight-warning">~$1억 9천만</span>
                        </td>
                      </tr>
                      <tr>
                        <td><strong>공격 유형</strong></td>
                        <td>메시지 검증 우회</td>
                      </tr>
                      <tr>
                        <td><strong>근본 원인</strong></td>
                        <td>프록시 업그레이드 시 0x00 신뢰 루트 설정</td>
                      </tr>
                      <tr>
                        <td><strong>악성 트랜잭션</strong></td>
                        <td>4건</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <p>
                  Nomad의 Replica 컨트랙트 업그레이드 중 <code>confirmAt</code>
                  매핑이 0x00 해시를 신뢰할 수 있는 루트로 설정했습니다. 이로 인해
                  증명되지 않은 모든 메시지가 자동 승인되어 대규모 자금 유출이
                  발생했습니다.
                </p>

                <figure class="code-block code-block--solidity">
                  <figcaption class="code__caption">취약점 코드</figcaption>
                  <pre class="code__pre"><code class="code__content">function initialize(
    uint32 _remoteDomain,
    address _updater,
    bytes32 _committedRoot,  // 업그레이드 중 0x00으로 설정됨
    uint256 _optimisticSeconds
) public initializer {
    // ...
    confirmAt[_committedRoot] = 1;  // 0x00이 신뢰됨
}</code></pre>
                </figure>

                <p><strong>공격 패턴 지표</strong>:</p>
                <ul class="content__list">
                  <li>비정상적인 루트 값을 가진 메시지</li>
                  <li>반복되는 트랜잭션 패턴 (수신자만 변경)</li>
                  <li>최대 유동성 인출</li>
                  <li>다중 토큰 타입 (WBTC, WETH, USDC, USDT, DAI)</li>
                </ul>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">
                  6.4.2 Audius (2022년 7월)
                </h4>

                <figure class="table-container">
                  <figcaption class="table__caption">사고 개요</figcaption>
                  <table class="data-table data-table--metrics">
                    <tbody>
                      <tr>
                        <td><strong>발생일</strong></td>
                        <td>2022년 7월 23일</td>
                      </tr>
                      <tr>
                        <td><strong>피해 규모</strong></td>
                        <td>
                          <span class="highlight-warning">~$600만</span> (18M
                          AUDIO)
                        </td>
                      </tr>
                      <tr>
                        <td><strong>공격 유형</strong></td>
                        <td>스토리지 충돌 / 재초기화</td>
                      </tr>
                      <tr>
                        <td><strong>근본 원인</strong></td>
                        <td>OpenZeppelin Initializable 스토리지 충돌</td>
                      </tr>
                      <tr>
                        <td><strong>악성 트랜잭션</strong></td>
                        <td>2건</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <p>
                  Audius의 프록시 컨트랙트와 OpenZeppelin의
                  <code>Initializable</code> 컨트랙트 간에 스토리지 슬롯 0 충돌이
                  발생했습니다. 공격자는 이미 배포된 컨트랙트에서
                  <code>initialize()</code>를 호출하여 거버넌스를 장악하고 재무부를
                  탈취했습니다.
                </p>

                <p><strong>공격 패턴 지표</strong>:</p>
                <ul class="content__list">
                  <li>배포된 컨트랙트에서 재초기화 호출</li>
                  <li>비정상적으로 큰 투표 위임</li>
                  <li>빠른 제안 실행</li>
                  <li>재무부에서 직접 전송</li>
                </ul>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">
                  6.4.3 SushiSwap RouteProcessor2 (2023년 4월)
                </h4>

                <figure class="table-container">
                  <figcaption class="table__caption">사고 개요</figcaption>
                  <table class="data-table data-table--metrics">
                    <tbody>
                      <tr>
                        <td><strong>발생일</strong></td>
                        <td>2023년 4월 9일</td>
                      </tr>
                      <tr>
                        <td><strong>피해 규모</strong></td>
                        <td>
                          <span class="highlight-warning">~$330만</span>
                        </td>
                      </tr>
                      <tr>
                        <td><strong>공격 유형</strong></td>
                        <td>승인 버그 / 미검증 외부 파라미터</td>
                      </tr>
                      <tr>
                        <td><strong>근본 원인</strong></td>
                        <td>RouteProcessor2의 풀 주소 검증 누락</td>
                      </tr>
                      <tr>
                        <td><strong>악성 트랜잭션</strong></td>
                        <td>2건</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <p>
                  RouteProcessor2 컨트랙트가 <code>route</code> 파라미터로 제공된
                  풀 주소를 검증하지 않아, 공격자가 가짜 풀 컨트랙트를 사용하여
                  RouteProcessor2에 승인한 사용자의 토큰을 탈취했습니다.
                </p>

                <p><strong>공격 패턴 지표</strong>:</p>
                <ul class="content__list">
                  <li>검증되지 않은 풀 주소로부터의 콜백</li>
                  <li>원래 호출자가 아닌 피해자로부터의 <code>transferFrom</code></li>
                  <li>고액의 단일 트랜잭션</li>
                  <li>즉각적인 토큰 변환</li>
                </ul>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">
                  6.4.4 Shata Capital EFVault (2023년 2월)
                </h4>

                <figure class="table-container">
                  <figcaption class="table__caption">사고 개요</figcaption>
                  <table class="data-table data-table--metrics">
                    <tbody>
                      <tr>
                        <td><strong>발생일</strong></td>
                        <td>2023년 2월 24일</td>
                      </tr>
                      <tr>
                        <td><strong>피해 규모</strong></td>
                        <td>
                          <span class="highlight-warning">~$514만</span>
                        </td>
                      </tr>
                      <tr>
                        <td><strong>공격 유형</strong></td>
                        <td>파라미터 검증 버그</td>
                      </tr>
                      <tr>
                        <td><strong>근본 원인</strong></td>
                        <td>컨트랙트 업그레이드 후 불충분한 검증</td>
                      </tr>
                      <tr>
                        <td><strong>악성 트랜잭션</strong></td>
                        <td>2건</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <p>
                  컨트랙트 업그레이드 후 도입된 파라미터 검증 취약점으로 인해
                  공격자가 보안 검사를 우회하고 무단 자금 인출을 실행했습니다.
                </p>

                <p><strong>공격 패턴 지표</strong>:</p>
                <ul class="content__list">
                  <li>비정상적인 파라미터 값</li>
                  <li>경계값 익스플로잇</li>
                  <li>업그레이드 직후 타이밍</li>
                </ul>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">
                  6.4.5 TrustSwap (참조 데이터셋)
                </h4>

                <figure class="table-container">
                  <figcaption class="table__caption">데이터셋 개요</figcaption>
                  <table class="data-table data-table--metrics">
                    <tbody>
                      <tr>
                        <td><strong>프로토콜 유형</strong></td>
                        <td>토큰 잠금/베스팅 플랫폼</td>
                      </tr>
                      <tr>
                        <td><strong>데이터셋 역할</strong></td>
                        <td>참조/베이스라인 (해당 기간 익스플로잇 없음)</td>
                      </tr>
                      <tr>
                        <td><strong>총 트랜잭션</strong></td>
                        <td>30,146건</td>
                      </tr>
                      <tr>
                        <td><strong>정상</strong></td>
                        <td>27,024건</td>
                      </tr>
                      <tr>
                        <td><strong>제외</strong></td>
                        <td>3,122건</td>
                      </tr>
                    </tbody>
                  </table>
                </figure>

                <p>
                  TrustSwap 데이터는 정상적인 DeFi 컨트랙트 상호작용의
                  <strong>참조 베이스라인</strong>으로 사용됩니다. 다른 4개
                  프로젝트와 달리, 이 기간 동안 익스플로잇이 없었습니다.
                </p>

                <blockquote class="note">
                  <p class="note__label">참고</p>
                  <p class="note__content">
                    TrustSwap은 2024년 9월에 재진입 공격을 경험했지만, 이
                    데이터셋은 해당 사고 이전 시점의 스냅샷입니다.
                  </p>
                </blockquote>
              </section>
            </section>

            <section id="section-6-5" class="report__subsection">
              <h3 class="subsection__title">6.5 연구자 권장사항</h3>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">ML 모델 훈련</h4>
                <ul class="content__list">
                  <li>
                    <strong>주요 훈련 데이터</strong>: TrustSwap의 30K+ 정상
                    샘플을 기반으로 훈련
                  </li>
                  <li>
                    <strong>교차 검증</strong>: 다른 프로젝트의 정상 트랜잭션으로
                    교차 검증
                  </li>
                  <li>
                    <strong>클래스 불균형 주의</strong>: 극심한 불균형 (악성 10건
                    vs 정상 38,000건)
                  </li>
                </ul>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">피처 엔지니어링 제안</h4>
                <ol class="content__list">
                  <li>
                    <strong>콜 그래프 피처</strong>: 깊이, 너비, 콜 타입 비율
                  </li>
                  <li>
                    <strong>가스 피처</strong>: 총량, 콜당 평균, 분산
                  </li>
                  <li>
                    <strong>상태 피처</strong>: 읽기/쓰기 비율, 고유 스토리지 키
                  </li>
                  <li>
                    <strong>주소 피처</strong>: 새 주소, 알려진 컨트랙트
                  </li>
                  <li>
                    <strong>값 피처</strong>: ETH 전송량, 토큰 금액
                  </li>
                </ol>
              </section>

              <section class="report__subsubsection">
                <h4 class="subsubsection__title">이상징후 탐지 접근법</h4>
                <p>정상 트랜잭션에서 베이스라인 분포를 설정하고, 다음을 플래그:</p>
                <ul class="content__list">
                  <li>평균에서 2 표준편차 이상인 콜 깊이</li>
                  <li>비정상적인 가스 사용량</li>
                  <li>높은 상태 쓰기 비율</li>
                  <li>비정상적인 토큰 전송 패턴</li>
                </ul>
              </section>

              <blockquote class="theorem">
                <p class="theorem__label"><strong>악성 트랜잭션 특성 요약</strong></p>
                <p class="theorem__content">
                  악성 트랜잭션의 공통 패턴: (1) 정상보다 1.5~2배 높은 가스 소비,
                  (2) 더 깊은 콜 스택 (6~10 레벨 vs 3~5 레벨), (3) 비정상적인
                  스토리지 수정, (4) 고액 토큰 전송, (5) 새로운 수신자 주소로의
                  전송.
                </p>
              </blockquote>
            </section>
          </section>

          <hr />

          <!-- Sources -->
          <section id="sources" class="report__section">
            <h2 class="section__title">Sources</h2>

            <div class="sources">
              <div class="sources__section">
                <h3 class="sources__subtitle">BlockScan</h3>
                <ul class="sources__list">
                  <li class="sources__item">
                    <a
                      href="https://arxiv.org/html/2410.04039v5"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >BlockScan: Detecting Anomalies in Blockchain Transactions
                      (arXiv)</a
                    >
                  </li>
                  <li class="sources__item">
                    <a
                      href="https://neurips.cc/virtual/2025/poster/117763"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >NeurIPS 2025 Poster</a
                    >
                  </li>
                </ul>
              </div>

              <div class="sources__section">
                <h3 class="sources__subtitle">BlockGPT</h3>
                <ul class="sources__list">
                  <li class="sources__item">
                    <a
                      href="https://rdi.berkeley.edu/blockchain-llm/"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >Blockchain Large Language Models (Berkeley RDI)</a
                    >
                  </li>
                  <li class="sources__item">
                    <a
                      href="https://arxiv.org/abs/2304.12749"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >arXiv Paper</a
                    >
                  </li>
                  <li class="sources__item">
                    <a
                      href="https://eprint.iacr.org/2023/592"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >Cryptology ePrint Archive</a
                    >
                  </li>
                  <li class="sources__item">
                    <a
                      href="https://d23e.ch/research/blockgpt"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >D23E Research</a
                    >
                  </li>
                </ul>
              </div>

              <div class="sources__section">
                <h3 class="sources__subtitle">AnoFormer</h3>
                <ul class="sources__list">
                  <li class="sources__item">
                    <a
                      href="https://openreview.net/pdf?id=iAWNOXfLz0"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >Time Series Anomaly Detection using Transformer-based GAN
                      with Two-Step Masking (OpenReview)</a
                    >
                  </li>
                  <li class="sources__item">
                    <a
                      href="https://ieeexplore.ieee.org/document/10164104/"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >IEEE Access</a
                    >
                  </li>
                </ul>
              </div>

              <div class="sources__section">
                <h3 class="sources__subtitle">추가 참고 자료</h3>
                <ul class="sources__list">
                  <li class="sources__item">
                    <a
                      href="https://arxiv.org/html/2403.14280v3"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >Large Language Models for Blockchain Security</a
                    >
                  </li>
                  <li class="sources__item">
                    <a
                      href="https://www.mdpi.com/2076-3417/15/15/8330"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >Anomaly Detection in Blockchain: A Systematic Review</a
                    >
                  </li>
                  <li class="sources__item">
                    <a
                      href="https://www.sciencedirect.com/science/article/abs/pii/S0952197625029999"
                      class="sources__link"
                      target="_blank"
                      rel="noopener noreferrer"
                      >The Role of Transformer Models in Advancing Blockchain
                      Technology</a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </section>
        </article>
      </main>

      <!-- 푸터 -->
      <footer class="site-footer">
        <p>
          &copy; 2025 블록체인 이상징후 탐지 연구 보고서. 학술 논문 및 공식 연구
          자료 기반.
        </p>
      </footer>

      <!-- 모바일 TOC 토글 버튼 -->
      <button class="toc-toggle" id="tocToggle" aria-label="목차 열기">
        ☰
      </button>
    </div>

    <script src="js/main.js"></script>
  </body>
</html>
